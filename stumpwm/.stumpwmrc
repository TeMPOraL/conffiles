;;; -*-lisp-*-
;;; Yay, my fist StumpWM config xD.

(in-package :stumpwm)

(setf *screen-mode-line-format*
      (list "%g|%v^>^B%d^b"))

(setf *time-modeline-string*
      "%a %b %e^2 %H:%M:%S^n")

(defun cat (&rest strings) "Concatenates strings, like the Unix command 'cat'. A shortcut for (concatenate 'string foo bar)."
       (apply 'concatenate 'string strings))

;;; modeline
;(screen-mode-line-mode (current-screen) t)

;;; GROUPS
(defun group-exists-p (group-name)
  (find-if (lambda (group)
             (string= group-name
                      (group-name group)))
           (screen-groups (current-screen))))

(defun ensure-group (group-name)
  (unless (group-exists-p group-name)
    (stumpwm::run-commands (cat "gnewbg " group-name))))

(setf (group-name (first (screen-groups (current-screen)))) "Terminals")

(ensure-group "Emacs")
(ensure-group "Browser")
(ensure-group "SQL")
(ensure-group "IRC")

;; bind g-e to switch to Emacs group.
;; bind g-b to switch to browser group.
;; bind g-t to switch to terminal group.

;;; TODO make some direct connection to Alice xD.

(defcommand color-map () ()
            "Show current color map."
            (echo-string (current-screen) "^0 0^1 1^2 2^3 3^4 4^5 5^6 6^7 7"))
